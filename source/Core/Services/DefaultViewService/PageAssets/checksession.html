<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Check Session IFrame</title>
</head>
<body>
    <script id="cookie-name" type="application/json">{cookieName}</script>
    <script src="{rootUrl}/assets/app.crypto.js"></script>
    <script>
        var cookieName = document.getElementById("cookie-name").textContent.trim();
        
        function getCookies() {
            var allCookies = document.cookie;
            var cookies = allCookies.split(';');
            return cookies.map(function (value) {
                var parts = value.trim().split('=');
                if (parts.length === 2) {
                    return {
                        name: parts[0].trim(),
                        value: parts[1].trim()
                    };
                }
            }).filter(function (item) {
                return item && item.name && item.value;
            });
        }

        function getBrowserState() {
            var cookies = getCookies().filter(function (cookie) {
                return (cookie.name == cookieName);
            });
            return cookies[0] && cookies[0].value;
        }

        function hash(value) {
            var hash = CryptoJS.SHA256(value);
            return hextob64u(hash);
        }

        window.addEventListener("message", function (e) {
            console.log("message", e.origin, e.data);

            //if (e.data === localStorage.getItem("ss")) {
            //    e.source.postMessage("unchanged", e.origin);
            //}
            //else {
            //    e.source.postMessage("changed", e.origin);
            //}

        }, false);

    </script>
</body>
</html>